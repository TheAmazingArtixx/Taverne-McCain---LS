<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Taverne McCain</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700;900&display=swap');
        body{font-family:'Poppins',sans-serif}
        .scratch-card{position:relative;width:100%;height:400px;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);border-radius:20px;overflow:hidden;cursor:crosshair}
        .scratch-content{position:absolute;top:0;left:0;width:100%;height:100%;display:flex;flex-direction:column;justify-content:center;align-items:center;z-index:1}
    </style>
</head>
<body class="bg-gradient-to-br from-amber-50 to-orange-100">
    <div id="app"></div>
    <script>
        var DISCORD_CLIENT_ID='1441487940776890511';
        var REDIRECT_URI=window.location.origin;
        var WEBHOOK_URL='https://discord.com/api/webhooks/1441176217700139019/kZ73H7dY-5CXVAJtV4M9gpP7PfXBQ6jSl85pd-2RSttc1aoB80N7SLtWwTJuIc2nOrJz';
        var products={bieres:[{id:'biere_blonde',name:'BiÃ¨re Blonde',price:5,emoji:'ğŸº'},{id:'biere_brune',name:'BiÃ¨re Brune',price:5.5,emoji:'ğŸº'},{id:'biere_ipa',name:'IPA',price:6,emoji:'ğŸº'},{id:'biere_pression',name:'Pression 50cl',price:7,emoji:'ğŸ»'}],cocktails:[{id:'mojito',name:'Mojito',price:8,emoji:'ğŸ¹'},{id:'martini',name:'Martini',price:9,emoji:'ğŸ¸'},{id:'pinacolada',name:'Pina Colada',price:8.5,emoji:'ğŸ¹'},{id:'margarita',name:'Margarita',price:8,emoji:'ğŸ¹'}],spiritueux:[{id:'whisky',name:'Whisky',price:7,emoji:'ğŸ¥ƒ'},{id:'vodka',name:'Vodka',price:6,emoji:'ğŸ¥ƒ'},{id:'rhum',name:'Rhum',price:6.5,emoji:'ğŸ¥ƒ'},{id:'gin',name:'Gin',price:7.5,emoji:'ğŸ¥ƒ'}],soft:[{id:'coca',name:'Coca-Cola',price:3,emoji:'ğŸ¥¤'},{id:'orangina',name:'Orangina',price:3,emoji:'ğŸ¥¤'},{id:'eau',name:'Eau',price:2,emoji:'ğŸ’§'},{id:'jus',name:'Jus de fruits',price:3.5,emoji:'ğŸ§ƒ'}],snacks:[{id:'chips',name:'Chips',price:3.5,emoji:'ğŸ¥”'},{id:'cacahuetes',name:'CacahuÃ¨tes',price:2.5,emoji:'ğŸ¥œ'},{id:'olives',name:'Olives',price:4,emoji:'ğŸ«’'},{id:'planche',name:'Planche mixte',price:12,emoji:'ğŸ§€'}]};
        var promoCodes={'HAPPY20':20,'BIENVENUE':10,'MCCAIN15':15};
        var validCodes={'TICKET2024':true,'JACKPOT500':true,'LUCKY777':true,'PROMO123':true,'WIN2024':true,'GOLD99':true};
        var prizes=[{amount:10,prob:0.3,color:'text-green-600',emoji:'ğŸ’µ'},{amount:50,prob:0.15,color:'text-blue-600',emoji:'ğŸ’°'},{amount:100,prob:0.08,color:'text-purple-600',emoji:'ğŸ'},{amount:500,prob:0.02,color:'text-yellow-600',emoji:'ğŸ†'},{amount:0,prob:0.45,color:'text-gray-600',emoji:'ğŸ˜¢'}];
        var state={user:null,cart:[],page:'home',promo:'',comment:'',orderHist:[],scratchHist:[],scratchCode:'',scratching:false,result:null,usedCodes:[]};
        var canvas,ctx,mouseDown=false,scratched=0;
        function getUser(){var f=new URLSearchParams(window.location.hash.slice(1));var t=f.get('access_token');if(t){fetch('https://discord.com/api/users/@me',{headers:{authorization:'Bearer '+t}}).then(function(r){return r.json()}).then(function(u){state.user=u;state.page='welcome';window.location.hash='';render()}).catch(console.error)}}
        function login(){window.location.href='https://discord.com/api/oauth2/authorize?client_id='+DISCORD_CLIENT_ID+'&redirect_uri='+encodeURIComponent(REDIRECT_URI)+'&response_type=token&scope=identify'}
        function logout(){state={user:null,cart:[],page:'home',promo:'',comment:'',orderHist:[],scratchHist:[],scratchCode:'',scratching:false,result:null,usedCodes:[]};render()}
        function addCart(p){var e=state.cart.find(function(i){return i.id===p.id});if(e){e.quantity++}else{state.cart.push(Object.assign({},p,{quantity:1}))}render()}
        function updateQty(id,q){if(q<=0){state.cart=state.cart.filter(function(i){return i.id!==id})}else{var i=state.cart.find(function(i){return i.id===id});if(i)i.quantity=q}render()}
        function calcSub(){return state.cart.reduce(function(s,i){return s+(i.price*i.quantity)},0)}
        function calcDisc(){return calcSub()*(promoCodes[state.promo]||0)/100}
        function calcTotal(){return calcSub()-calcDisc()}
        function order(){if(!state.cart.length){alert('Panier vide!');return}var items=state.cart.map(function(i){return i.emoji+' '+i.name+' x'+i.quantity}).join('\n');if(!confirm('Confirmer?\n\nTotal: '+calcTotal().toFixed(2)+'â‚¬\n\n'+items))return;var o={user:state.user.username,userId:state.user.id,items:state.cart,sub:calcSub().toFixed(2),disc:calcDisc().toFixed(2),total:calcTotal().toFixed(2),promo:state.promo||'Aucun',comment:state.comment||'Aucun',date:new Date().toLocaleString('fr-FR')};var txt=o.items.map(function(i){return i.emoji+' **'+i.name+'** x'+i.quantity+' - '+(i.price*i.quantity).toFixed(2)+'â‚¬'}).join('\n');var e={embeds:[{title:'ğŸº Commande - Taverne McCain',color:0xFFA500,fields:[{name:'ğŸ‘¤ Client',value:o.user+' ('+o.userId+')',inline:true},{name:'ğŸ“… Date',value:o.date,inline:true},{name:'ğŸ» Commande',value:txt},{name:'ğŸ’° Montant',value:'Sous-total: '+o.sub+'â‚¬\nRÃ©duction: -'+o.disc+'â‚¬\n**Total: '+o.total+'â‚¬**'},{name:'ğŸŸï¸ Code',value:o.promo,inline:true}],footer:{text:'Taverne McCain'},timestamp:new Date().toISOString()}]};if(state.comment!=='Aucun'){e.embeds[0].fields.push({name:'ğŸ’¬ Commentaire',value:state.comment})}fetch(WEBHOOK_URL,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(e)}).then(function(r){if(r.ok){state.orderHist.unshift(o);alert('âœ… Commande envoyÃ©e!');state.cart=[];state.promo='';state.comment='';state.page='orderHist';render()}else{alert('âŒ Erreur')}}).catch(function(){alert('âŒ Erreur rÃ©seau')})}
        function startScratch(){var c=state.scratchCode.toUpperCase().trim();if(!c){alert('Entrez un code!');return}if(!validCodes[c]){alert('âŒ Code invalide!');return}if(state.usedCodes.indexOf(c)!==-1){alert('âŒ Code dÃ©jÃ  utilisÃ©!');return}state.usedCodes.push(c);var r=Math.random(),cum=0,prize=prizes[prizes.length-1];for(var i=0;i<prizes.length;i++){cum+=prizes[i].prob;if(r<=cum){prize=prizes[i];break}}state.result=prize;state.scratching=true;render();setTimeout(function(){initCanvas()},100)}
        function initCanvas(){canvas=document.getElementById('canvas');if(!canvas)return;ctx=canvas.getContext('2d');canvas.width=canvas.parentElement.offsetWidth;canvas.height=400;var g=ctx.createLinearGradient(0,0,canvas.width,canvas.height);g.addColorStop(0,'#f093fb');g.addColorStop(1,'#f5576c');ctx.fillStyle=g;ctx.fillRect(0,0,canvas.width,canvas.height);ctx.font='bold 32px Poppins';ctx.fillStyle='white';ctx.textAlign='center';ctx.fillText('GRATTEZ ICI',canvas.width/2,canvas.height/2);ctx.font='48px Arial';ctx.fillText('ğŸª™',canvas.width/2,canvas.height/2+60);canvas.addEventListener('mousedown',function(){mouseDown=true});canvas.addEventListener('mouseup',function(){mouseDown=false});canvas.addEventListener('mousemove',scratch);canvas.addEventListener('touchstart',function(e){e.preventDefault();mouseDown=true});canvas.addEventListener('touchend',function(){mouseDown=false});canvas.addEventListener('touchmove',function(e){e.preventDefault();scratch(e.touches[0])})}
        function scratch(e){if(!mouseDown)return;var rect=canvas.getBoundingClientRect();var x=(e.clientX||e.pageX)-rect.left;var y=(e.clientY||e.pageY)-rect.top;ctx.globalCompositeOperation='destination-out';ctx.beginPath();ctx.arc(x,y,40,0,Math.PI*2);ctx.fill();check()}
        function check(){var d=ctx.getImageData(0,0,canvas.width,canvas.height).data;var t=0;for(var i=3;i<d.length;i+=4){if(d[i]===0)t++}scratched=(t/(d.length/4))*100;if(scratched>70){reveal()}}
        function reveal(){mouseDown=false;var s={user:state.user.username,userId:state.user.id,code:state.scratchCode,prize:state.result.amount,date:new Date().toLocaleString('fr-FR')};state.scratchHist.unshift(s);var e={embeds:[{title:'ğŸ° Ticket - Taverne McCain',color:state.result.amount>0?0x00FF00:0xFF0000,fields:[{name:'ğŸ‘¤ Joueur',value:s.user+' ('+s.userId+')',inline:true},{name:'ğŸŸï¸ Code',value:s.code,inline:true},{name:state.result.amount>0?'ğŸ‰ GAGNÃ‰!':'ğŸ˜¢ Perdu',value:state.result.amount>0?'**'+state.result.amount+'â‚¬**':'Pas de gain'},{name:'ğŸ“… Date',value:s.date}],footer:{text:'Taverne McCain'},timestamp:new Date().toISOString()}]};fetch(WEBHOOK_URL,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(e)});setTimeout(function(){alert(state.result.amount>0?'ğŸ‰ GagnÃ© '+state.result.amount+'â‚¬!':'ğŸ˜¢ Pas de gain...');state.scratching=false;state.scratchCode='';state.result=null;scratched=0;render()},500)}
        function render(){var app=document.getElementById('app');var nav=state.user?'<nav class="bg-orange-800 text-white shadow-lg"><div class="container mx-auto px-4 py-4"><div class="flex items-center justify-between flex-wrap gap-4"><h1 class="text-2xl font-bold">ğŸº Taverne McCain</h1><div class="flex flex-wrap items-center gap-4 text-sm md:text-base"><button onclick="state.page=\'welcome\';render()" class="hover:text-orange-200 '+(state.page==='welcome'?'text-orange-200':'')+'">ğŸ  Accueil</button><button onclick="state.page=\'shop\';render()" class="hover:text-orange-200 '+(state.page==='shop'?'text-orange-200':'')+'">ğŸ›’ Commander</button><button onclick="state.page=\'scratch\';render()" class="hover:text-orange-200 '+(state.page==='scratch'?'text-orange-200':'')+'">ğŸ° Ticket</button><button onclick="state.page=\'profile\';render()" class="hover:text-orange-200 '+(state.page==='profile'?'text-orange-200':'')+'">ğŸ‘¤ Profil</button><button onclick="logout()" class="hover:text-red-200">ğŸšª Sortir</button></div></div></div></nav>':'';if(!state.user){app.innerHTML='<div><nav class="bg-orange-800 text-white shadow-lg py-4"><div class="container mx-auto px-4"><h1 class="text-3xl font-bold text-center">ğŸº Taverne McCain</h1></div></nav><div class="container mx-auto px-4 py-12"><div class="max-w-6xl mx-auto"><section class="bg-white rounded-2xl shadow-2xl p-8 mb-8"><div class="text-center mb-12"><h2 class="text-4xl md:text-5xl font-bold text-orange-800 mb-4">Bienvenue Ã  la Taverne McCain</h2><p class="text-xl text-gray-600">Bar en ligne avec jeux</p></div><div class="grid md:grid-cols-3 gap-8 mb-12"><div class="text-center p-6 bg-orange-50 rounded-xl"><div class="text-5xl mb-4">ğŸº</div><h3 class="text-2xl font-bold text-orange-800 mb-2">Bar Complet</h3><p class="text-gray-600">BiÃ¨res, cocktails, softs</p></div><div class="text-center p-6 bg-orange-50 rounded-xl"><div class="text-5xl mb-4">ğŸ°</div><h3 class="text-2xl font-bold text-orange-800 mb-2">Tickets</h3><p class="text-gray-600">Gagnez jusqu\'Ã  500â‚¬</p></div><div class="text-center p-6 bg-orange-50 rounded-xl"><div class="text-5xl mb-4">ğŸš€</div><h3 class="text-2xl font-bold text-orange-800 mb-2">Livraison</h3><p class="text-gray-600">Commande en ligne</p></div></div><div class="text-center"><button onclick="login()" class="bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-4 px-8 md:px-12 rounded-xl inline-flex items-center gap-3 transform hover:scale-105 text-lg md:text-xl"><svg class="w-6 h-6 md:w-8 md:h-8" fill="currentColor" viewBox="0 0 24 24"><path d="M20.317 4.37a19.791 19.791 0 0 0-4.885-1.515a.074.074 0 0 0-.079.037c-.21.375-.444.864-.608 1.25a18.27 18.27 0 0 0-5.487 0a12.64 12.64 0 0 0-.617-1.25a.077.077 0 0 0-.079-.037A19.736 19.736 0 0 0 3.677 4.37a.07.07 0 0 0-.032.027C.533 9.046-.32 13.58.099 18.057a.082.082 0 0 0 .031.057a19.9 19.9 0 0 0 5.993 3.03a.078.078 0 0 0 .084-.028a14.09 14.09 0 0 0 1.226-1.994a.076.076 0 0 0-.041-.106a13.107 13.107 0 0 1-1.872-.892a.077.077 0 0 1-.008-.128a10.2 10.2 0 0 0 .372-.292a.074.074 0 0 1 .077-.01c3.928 1.793 8.18 1.793 12.062 0a.074.074 0 0 1 .078.01c.12.098.246.198.373.292a.077.077 0 0 1-.006.127a12.299 12.299 0 0 1-1.873.892a.077.077 0 0 0-.041.107c.36.698.772 1.362 1.225 1.993a.076.076 0 0 0 .084.028a19.839 19.839 0 0 0 6.002-3.03a.077.077 0 0 0 .032-.054c.5-5.177-.838-9.674-3.549-13.66a.061.061 0 0 0-.031-.03zM8.02 15.33c-1.183 0-2.157-1.085-2.157-2.419c0-1.333.956-2.419 2.157-2.419c1.21 0 2.176 1.096 2.157 2.42c0 1.333-.956 2.418-2.157 2.418zm7.975 0c-1.183 0-2.157-1.085-2.157-2.419c0-1.333.955-2.419 2.157-2.419c1.21 0 2.176 1.096 2.157 2.42c0 1.333-.946 2.418-2.157 2.418z"/></svg>Connexion Discord</button></div></section><section class="bg-white rounded-2xl shadow-2xl p-8 mb-8"><h2 class="text-3xl font-bold text-orange-800 mb-6 text-center">Tarifs</h2><div class="grid md:grid-cols-2 gap-6">'+Object.keys(products).map(function(c){return'<div class="bg-orange-50 p-6 rounded-xl"><h3 class="text-xl font-bold text-orange-800 mb-4 capitalize">'+c+'</h3><div class="space-y-2">'+products[c].map(function(p){return'<div class="flex justify-between"><span>'+p.emoji+' '+p.name+'</span><span class="font-bold">'+p.price.toFixed(2)+'â‚¬</span></div>'}).join('')+'</div></div>'}).join('')+'</div></section><section class="bg-white rounded-2xl shadow-2xl p-8"><h2 class="text-3xl font-bold text-orange-800 mb-6 text-center">Partenaires</h2><div class="grid grid-cols-2 md:grid-cols-4 gap-4 text-center"><div class="p-4 bg-gray-50 rounded-xl"><div class="text-3xl md:text-4xl mb-2">ğŸ¢</div><p class="font-semibold text-sm md:text-base">Brasserie</p></div><div class="p-4 bg-gray-50 rounded-xl"><div class="text-3xl md:text-4xl mb-2">ğŸ·</div><p class="font-semibold text-sm md:text-base">Cave Ã  Vins</p></div><div class="p-4 bg-gray-50 rounded-xl"><div class="text-3xl md:text-4xl mb-2">ğŸª</div><p class="font-semibold text-sm md:text-base">Events</p></div><div class="p-4 bg-gray-50 rounded-xl"><div class="text-3xl md:text-4xl mb-2">ğŸµ</div><p class="font-semibold text-sm md:text-base">DJ</p></div></div></section></div></div></div>';return}if(state.page==='welcome'){app.innerHTML=nav+'<div class="container mx-auto px-4 py-8 md:py-12"><div class="max-w-4xl mx-auto text-center"><div class="bg-white rounded-2xl shadow-2xl p-6 md:p-12"><h1 class="text-3xl md:text-5xl font-bold text-orange-800 mb-4">Bienvenue '+state.user.username+'! ğŸº</h1><p class="text-lg md:text-xl text-gray-600 mb-8">Que voulez-vous faire?</p><div class="grid md:grid-cols-2 gap-6"><button onclick="state.page=\'shop\';render()" class="bg-orange-600 hover:bg-orange-700 text-white font-bold py-6 md:py-8 px-6 rounded-xl transform hover:scale-105"><div class="text-4xl md:text-5xl mb-4">ğŸ›’</div><div class="text-xl md:text-2xl">Commander</div></button><button onclick="state.page=\'scratch\';render()" class="bg-purple-600 hover:bg-purple-700 text-white font-bold py-6 md:py-8 px-6 rounded-xl transform hover:scale-105"><div class="text-4xl md:text-5xl mb-4">ğŸ°</div><div class="text-xl md:text-2xl">Ticket</div></button></div></div></div></div>'}else if(state.page==='scratch'){if(!state.scratching){var hist='';if(state.scratchHist.length){hist='<div class="mt-8 bg-white rounded-xl shadow-lg p-6"><h3 class="text-xl font-bold text-orange-800 mb-4">Historique</h3><div class="space-y-2">'+state.scratchHist.slice(0,5).map(function(e){return'<div class="flex justify-between p-3 bg-gray-50 rounded-lg"><div><p class="font-semibold">'+e.code+'</p><p class="text-xs md:text-sm text-gray-600">'+e.date+'</p></div><p class="'+(e.prize>0?'text-green-600':'text-gray-600')+' font-bold">'+(e.prize>0?'+'+e.prize+'â‚¬':'Perdu')+'</p></div>'}).join('')+'</div></div>'}app.innerHTML=nav+'<div class="container mx-auto px-4 py-8"><div class="max-w-2xl mx-auto"><div class="bg-white rounded-2xl shadow-2xl p-6 md:p-8"><h2 class="text-2xl md:text-3xl font-bold text-orange-800 mb-6 text-center">ğŸ° Ticket Ã  Gratter</h2><div class="bg-gradient-to-r from-purple-100 to-pink-100 p-6 rounded-xl mb-6"><p class="text-center text-base md:text-lg mb-4">Entrez votre code</p><input type="text" value="'+state.scratchCode+'" oninput="state.scratchCode=this.value" placeholder="CODE" class="w-full px-4 py-3 border-2 border-purple-300 rounded-lg mb-4 text-center text-lg font-bold uppercase"><button onclick="startScratch()" class="w-full bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 text-white font-bold py-4 rounded-lg text-xl">Gratter</button></div><div class="bg-yellow-50 border-2 border-yellow-300 rounded-xl p-4 mb-4"><p class="text-center font-semibold text-yellow-800 mb-2">ğŸ’¡ Codes valides:</p><div class="grid grid-cols-2 gap-2 text-center text-xs md:text-sm"><span class="bg-white px-2 py-2 rounded font-mono">TICKET2024</span><span class="bg-white px-2 py-2 rounded font-mono">JACKPOT500</span><span class="bg-white px-2 py-2 rounded font-mono">LUCKY777</span><span class="bg-white px-2 py-2 rounded font-mono">PROMO123</span></div></div><p class="text-center text-sm text-gray-600">ğŸ† Gains: 10â‚¬, 50â‚¬, 100â‚¬, 500â‚¬</p>'+hist+'</div></div></div>'}else{app.innerHTML=nav+'<div class="container mx-auto px-4 py-8"><div class="max-w-3xl mx-auto"><div class="bg-white rounded-2xl shadow-2xl p-6 md:p-8"><h2 class="text-2xl md:text-3xl font-bold text-orange-800 mb-6 text-center">Grattez!</h2><div style="position:relative;"><div class="scratch-content"><div class="text-center"><div class="text-6xl md:text-8xl mb-4 '+state.result.color+'">'+state.result.emoji+'</div><h3 class="text-3xl md:text-5xl font-bold '+state.result.color+' mb-2">'+(state.result.amount>0?state.result.amount+'â‚¬':'Perdu')+'</h3><p class="text-xl md:text-2xl text-gray-600">'+(state.result.amount>0?'BRAVO!':'RÃ©essayez')+'</p></div></div><canvas id="canvas"></canvas></div><p class="text-center text-gray-600 mt-6 text-sm md:text-base">Grattez avec votre souris</p></div></div></div>'}}else if(state.page==='shop'){var prods='';for(var cat in products){var items='';products[cat].forEach(function(p){items+='<div class="flex items-center justify-between bg-orange-50 p-3 md:p-4 rounded-lg hover:bg-orange-100"><div class="flex items-center gap-2 md:gap-3"><span class="text-2xl md:text-3xl">'+p.emoji+'</span><div><p class="font-semibold text-sm md:text-base">'+p.name+'</p><p class="text-xs md:text-sm text-gray-600">'+p.price.toFixed(2)+'â‚¬</p></div></div><button onclick="addCart('+JSON.stringify(p).replace(/"/g,'&quot;')+')" class="bg-orange-600 hover:bg-orange-700 text-white px-3 md:px-4 py-2 rounded-lg text-sm md:text-base">+</button></div>'});prods+='<div class="bg-white rounded-xl shadow-lg p-4 md:p-6"><h2 class="text-xl md:text-2xl font-bold text-orange-800 mb-4 capitalize">'+cat+'</h2><div class="space-y-2">'+items+'</div></div>'}var cart='';if(!state.cart.length){cart='<p class="text-gray-500 text-center py-8">Vide</p>'}else{var items='';state.cart.forEach(function(i){items+='<div class="bg-orange-50 p-3 rounded-lg"><div class="flex justify-between mb-2"><span class="font-semibold text-sm md:text-base">'+i.emoji+' '+i.name+'</span><button onclick="updateQty(\''+i.id+'\',0)" class="text-red-600">âœ•</button></div><div class="flex justify-between"><div class="flex items-center gap-2 bg-white rounded px-2 py-1"><button onclick="updateQty(\''+i.id+'\','+(i.quantity-1)+')" class="text-orange-600">âˆ’</button><span class="font-bold w-8 text-center">'+i.quantity+'</span><button onclick="updateQty(\''+i.id+'\','+(i.quantity+1)+')" class="text-orange-600">+</button></div><span class="font-bold text-orange-700">'+(i.price*i.quantity).toFixed(2)+'â‚¬</span></div></div>'});var promo='';if(state.promo&&promoCodes[state.promo]){promo='<p class="text-green-600 text-sm">âœ“ -'+promoCodes[state.promo]+'%</p>'}else if(state.promo){promo='<p class="text-red-600 text-sm">âœ— Invalide</p>'}var disc='';if(calcDisc()>0){disc='<div class="flex justify-between text-sm text-green-600"><span>RÃ©duction:</span><span>-'+calcDisc().toFixed(2)+'â‚¬</span></div>'}cart='<div class="space-y-3 mb-4 max-h-64 overflow-y-auto">'+items+'</div><div class="border-t pt-4 space-y-3"><div class="flex justify-between text-sm"><span>Sous-total:</span><span>'+calcSub().toFixed(2)+'â‚¬</span></div><input type="text" value="'+state.promo+'" oninput="state.promo=this.value.toUpperCase();render()" placeholder="Code promo" class="w-full px-3 py-2 border rounded-lg text-sm">'+promo+disc+'<div class="flex justify-between text-lg font-bold text-orange-800 border-t pt-2"><span>Total:</span><span>'+calcTotal().toFixed(2)+'â‚¬</span></div><textarea oninput="state.comment=this.value" placeholder="Commentaire" class="w-full px-3 py-2 border rounded-lg resize-none text-sm" rows="3">'+state.comment+'</textarea><button onclick="order()" class="w-full bg-orange-600 hover:bg-orange-700 text-white font-bold py-3 rounded-lg">Commander</button></div>'}app.innerHTML=nav+'<div class="container mx-auto px-4 py-8"><div class="grid lg:grid-cols-3 gap-6"><div class="lg:col-span-2 space-y-6">'+prods+'</div><div class="lg:col-span-1"><div class="bg-white rounded-xl shadow-lg p-6 sticky top-6"><h2 class="text-2xl font-bold text-orange-800 mb-4">ğŸ›’ Panier</h2>'+cart+'</div></div></div></div>'}else if(state.page==='profile'){app.innerHTML=nav+'<div class="container mx-auto px-4 py-8"><div class="max-w-2xl mx-auto bg-white rounded-2xl shadow-2xl p-6 md:p-8"><h2 class="text-2xl md:text-3xl font-bold text-orange-800 mb-6">Mon Profil</h2><div class="space-y-4"><div class="flex items-center gap-4 p-4 bg-orange-50 rounded-lg"><img src="https://cdn.discordapp.com/avatars/'+state.user.id+'/'+state.user.avatar+'.png" class="w-12 h-12 md:w-16 md:h-16 rounded-full"/><div><p class="font-bold text-lg md:text-xl">'+state.user.username+'</p><p class="text-sm md:text-base text-gray-600">'+state.user.id+'</p></div></div><div class="p-4 bg-gray-50 rounded-lg"><p class="text-sm text-gray-600">Commandes</p><p class="font-semibold text-lg">'+state.orderHist.length+'</p></div><div class="p-4 bg-gray-50 rounded-lg"><p class="text-sm text-gray-600">Tickets grattÃ©s</p><p class="font-semibold text-lg">'+state.scratchHist.length+'</p></div></div></div></div>'}else if(state.page==='orderHist'){var hist='';if(!state.orderHist.length){hist='<div class="bg-white rounded-xl shadow-lg p-8 text-center"><div class="text-6xl mb-4">ğŸ“¦</div><p class="text-gray-500">Aucune commande</p></div>'}else{hist='<div class="space-y-4">'+state.orderHist.map(function(o,i){var items='';o.items.forEach(function(it){items+='<p class="text-sm text-gray-700">'+it.emoji+' '+it.name+' x'+it.quantity+' - '+(it.price*it.quantity).toFixed(2)+'â‚¬</p>'});var comm='';if(o.comment!=='Aucun'){comm='<div class="mt-3 p-3 bg-gray-50 rounded-lg"><p class="text-xs text-gray-600 mb-1">Commentaire:</p><p class="text-sm">'+o.comment+'</p></div>'}return'<div class="bg-white rounded-xl shadow-lg p-6"><div class="flex justify-between mb-4"><div><p class="text-lg font-bold text-orange-800">Commande #'+(state.orderHist.length-i)+'</p><p class="text-sm text-gray-600">'+o.date+'</p></div><p class="text-2xl font-bold text-orange-700">'+o.total+'â‚¬</p></div><div class="border-t pt-4"><p class="font-semibold mb-2">Articles:</p><div class="space-y-1">'+items+'</div>'+comm+'</div></div>'}).join('')+'</div>'}app.innerHTML=nav+'<div class="container mx-auto px-4 py-8"><div class="max-w-4xl mx-auto"><h2 class="text-3xl font-bold text-orange-800 mb-6">Historique</h2>'+hist+'</div></div>'}}window.addEventListener('load',function(){getUser();render()})
    </script>
</body>
</html>