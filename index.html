<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Taverne McCain</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700;900&display=swap');
        body{font-family:'Poppins',sans-serif}
        .scratch-ticket{position:relative;width:100%;max-width:500px;margin:0 auto;background:linear-gradient(135deg,#00CED1 0%,#20B2AA 50%,#9370DB 100%);border-radius:25px;overflow:hidden;border:10px solid #FFD700;box-shadow:0 20px 50px rgba(0,0,0,0.4)}
        .ticket-header{background:linear-gradient(135deg,#FF1493 0%,#9370DB 100%);padding:20px;position:relative}
        .illiko-badge{background:white;color:#FF1493;font-weight:900;padding:10px 20px;border-radius:30px;font-size:16px;display:inline-block;box-shadow:0 4px 10px rgba(0,0,0,0.3)}
        .nouveau-badge{background:#4169E1;color:white;font-weight:900;padding:5px 15px;border-radius:15px;font-size:12px;position:absolute;top:20px;left:20px}
        .price-badge{background:white;color:#FF1493;font-weight:900;padding:8px 16px;border-radius:50%;font-size:18px;position:absolute;top:20px;right:20px;border:3px solid #FFD700}
        .jackpot-title{font-size:clamp(32px,8vw,56px);font-weight:900;color:#FFA500;text-shadow:4px 4px 0 #FF4500,-2px -2px 0 #FFD700,2px -2px 0 #FFD700,-2px 2px 0 #FFD700;letter-spacing:3px;text-align:center;margin:20px 0;-webkit-text-stroke:2px #4169E1}
        .jackpot-amount{font-size:clamp(40px,10vw,72px);font-weight:900;color:#FFD700;text-shadow:4px 4px 0 #FF4500;text-align:center;-webkit-text-stroke:2px #4169E1;margin-bottom:20px}
        .winning-section{background:linear-gradient(135deg,#9370DB 0%,#8A2BE2 100%);padding:20px;margin:15px;border-radius:20px;border:5px solid #32CD32}
        .scratch-section{background:linear-gradient(135deg,#4169E1 0%,#1E90FF 100%);padding:20px;margin:15px;border-radius:20px;border:5px solid #32CD32;position:relative;min-height:350px}
        .section-title{color:white;font-weight:900;font-size:18px;text-align:center;margin-bottom:15px;text-shadow:2px 2px 4px rgba(0,0,0,0.5)}
        .winning-grid{display:grid;grid-template-columns:repeat(6,1fr);gap:12px}
        .winning-item{background:linear-gradient(145deg,#FFD700,#FFA500);border:4px solid #FF4500;border-radius:50%;width:100%;aspect-ratio:1;display:flex;align-items:center;justify-content:center;font-weight:900;font-size:28px;color:#8B0000;box-shadow:0 6px 12px rgba(0,0,0,0.4);animation:coinSpin 3s ease-in-out infinite}
        @keyframes coinSpin{0%,100%{transform:rotateY(0deg)}50%{transform:rotateY(180deg)}}
        .number-grid{display:grid;grid-template-columns:repeat(5,1fr);gap:10px;position:relative;z-index:1}
        .money-item{background:linear-gradient(145deg,#98FB98,#90EE90);border:4px solid #228B22;border-radius:12px;padding:15px 10px;text-align:center;font-weight:900;font-size:20px;color:#006400;box-shadow:0 6px 12px rgba(0,0,0,0.3);position:relative}
        .money-item::before{content:'üíµ';position:absolute;top:5px;left:5px;font-size:16px}
        .money-item.winner{background:linear-gradient(145deg,#FFD700,#FFA500);border-color:#FF4500;color:#8B0000;animation:winPulse 1s ease-in-out infinite}
        @keyframes winPulse{0%,100%{transform:scale(1)}50%{transform:scale(1.1)}}
        .scratch-canvas{position:absolute;top:0;left:0;width:100%;height:100%;cursor:crosshair;border-radius:20px;z-index:10}
        .footer-text{text-align:center;color:#FFD700;font-weight:900;font-size:14px;text-shadow:2px 2px 4px rgba(0,0,0,0.8);padding:15px;background:rgba(0,0,0,0.3);margin:15px;border-radius:15px}
        @media(max-width:640px){.winning-item{font-size:22px}.money-item{padding:12px 8px;font-size:18px}.jackpot-title{font-size:28px}.jackpot-amount{font-size:36px}}
    </style>
</head>
<body class="bg-gradient-to-br from-amber-50 to-orange-100">
    <div id="app"></div>
    <script>
        var DISCORD_CLIENT_ID='1441487940776890511',REDIRECT_URI=window.location.origin,WEBHOOK_URL='https://discord.com/api/webhooks/1441176217700139019/kZ73H7dY-5CXVAJtV4M9gpP7PfXBQ6jSl85pd-2RSttc1aoB80N7SLtWwTJuIc2nOrJz';
        var products={bieres:[{id:'b1',name:'Bi√®re Blonde',price:45,emoji:'üç∫'},{id:'b2',name:'Bi√®re Blanche',price:45,emoji:'üç∫'},{id:'b3',name:'Bi√®re Rouge',price:45,emoji:'üç∫'}],vins:[{id:'v1',name:'Vin',price:185,emoji:'üç∑'}],boissons:[{id:'d1',name:'Eau',price:30,emoji:'üíß'},{id:'d2',name:'Soda',price:35,emoji:'ü•§'}],snacks:[{id:'s1',name:'Chips',price:15,emoji:'ü•î'},{id:'s2',name:'Saucisson',price:15,emoji:'üå≠'}]};
        var promoCodes={'HAPPY20':20,'BIENVENUE':10,'MCCAIN15':15};
        var tickets={'MC7X9K2P':{w:0},'ZT4N8W1Q':{w:10},'BV6R3M5L':{w:0},'HJ2D7Y9K':{w:50},'PF8S1X4G':{w:0},'QN3T6Z2M':{w:100},'WR9V5L8H':{w:0},'KD1P7N4B':{w:10},'XG6M2Y9C':{w:0},'LF4W8K3J':{w:500},'TS7R1Q5D':{w:0},'NZ2X9P6V':{w:10},'MH8L4T1W':{w:0},'BC3N7M9R':{w:50},'YK6S2D8F':{w:0},'VJ1Z5W4P':{w:10},'QL9G3X7N':{w:0},'RT4H8M2K':{w:100},'FB7L1Y6C':{w:0},'DW2N9T5Q':{w:10},'PX6V3K8S':{w:0},'ZM1R7J4G':{w:50},'LC9D2P6H':{w:0},'NK4W8X1B':{w:10},'TF7S3Y9V':{w:0},'QG2M5Z8L':{w:100},'HX6N1Q4R':{w:0},'WJ9T7K2D':{w:10},'BP3L8M6C':{w:0},'VR1Y4P9F':{w:500},'KS5D7W3G':{w:0},'ZN8X2J6H':{w:10},'MT4Q9L1V':{w:0},'FC7R3N8K':{w:50},'GH2S6Z4P':{w:0},'LW9M1Y7B':{w:10},'XD5K8T3J':{w:0},'NP1V6Q9C':{w:100},'TJ4L2X7R':{w:0},'QF8W5M1D':{w:10},'BY3N7K6G':{w:0},'ZR9P2Y4H':{w:50},'MS6D1Z8L':{w:0},'HC4X7T3V':{w:10},'KG1S9Q5B':{w:0},'WN8J2M6F':{w:100},'PL5R7W4C':{w:0},'VT3Y1K9P':{w:10},'FX6N8D2J':{w:0},'BM9Z4L7G':{w:500},'RQ2H5X1K':{w:0},'GS7P3T8V':{w:10},'JW4M9Y6C':{w:0},'ND1L8K2B':{w:50},'ZF6R3Q9H':{w:0},'XT5S7N1D':{w:10},'QY8W2P4F':{w:0},'LK3J9M6G':{w:100},'VB7T1X5L':{w:0},'HC9D4Z8R':{w:10},'PM2N6Y3K':{w:0},'FW5Q8L1C':{w:50},'GX1S7K9V':{w:0},'TR4J2P6B':{w:10},'NM8R9T3H':{w:0},'ZD6W1Y5F':{w:100},'KL3X7N4G':{w:0},'BQ9Z2M8C':{w:10},'VP5S4K1J':{w:0},'HT8D6L9P':{w:500},'WJ2Y3X7R':{w:0},'FC1N9Q5K':{w:10},'GR7M4T8B':{w:0},'LX6P2W1V':{w:50},'NS3K5Z9H':{w:0},'QD8Y7J4C':{w:10},'ZT1L6M3F':{w:0},'MW9R4X2G':{w:100},'BH5S8N1K':{w:0},'PJ2D7Q6V':{w:10},'KF6W3Y9L':{w:0},'VG1Z8K4C':{w:50},'TX7N2M5H':{w:0},'RC4P9L1B':{w:10},'HS8J5X3P':{w:0},'NQ3T6W9F':{w:100},'WM1Y7D2K':{w:0},'FL6K4Z8G':{w:10},'GX9S2Q5V':{w:0},'ZB5R3N7C':{w:500},'PT8L1M4J':{w:0},'KD2W6Y9H':{w:10},'VN7X4K1B':{w:0},'QJ3Z9P5F':{w:50},'MS6T2L8G':{w:0},'HC1Q7R4K':{w:10},'BW9D5N3V':{w:0},'FR4Y8M2C':{w:100},'GS2X6J9P':{w:0},'LZ7K1T5H':{w:10}};
        var globalScratched=[];
        var state={user:null,cart:[],page:'home',promos:[],comment:'',orderHist:[],code:'',scratching:false,win:0,winNums:[],yourNums:[],used:[],currentPromo:'',promoFocused:false};
        var canvas,ctx,down=false,pct=0;
        function getUser(){var f=new URLSearchParams(window.location.hash.slice(1)),t=f.get('access_token');if(t)fetch('https://discord.com/api/users/@me',{headers:{authorization:'Bearer '+t}}).then(function(r){return r.json()}).then(function(u){state.user=u;state.page='welcome';window.location.hash='';render()}).catch(console.error)}
        function login(){window.location.href='https://discord.com/api/oauth2/authorize?client_id='+DISCORD_CLIENT_ID+'&redirect_uri='+encodeURIComponent(REDIRECT_URI)+'&response_type=token&scope=identify'}
        function logout(){state={user:null,cart:[],page:'home',promos:[],comment:'',orderHist:[],code:'',scratching:false,win:0,winNums:[],yourNums:[],used:[],currentPromo:'',promoFocused:false};render()}
        function addCart(p){var e=state.cart.find(function(i){return i.id===p.id});if(e)e.quantity++;else state.cart.push(Object.assign({},p,{quantity:1}));render()}
        function updateQty(id,q){if(q<=0)state.cart=state.cart.filter(function(i){return i.id!==id});else{var i=state.cart.find(function(i){return i.id===id});if(i)i.quantity=q}render()}
        function promoKeyPress(e){if(e.key.length===1&&/[A-Z0-9]/.test(e.key.toUpperCase())){state.currentPromo+=e.key.toUpperCase();render()}}
        function addPromo(){var c=state.currentPromo.toUpperCase().trim();if(!c)return;if(promoCodes[c]&&state.promos.indexOf(c)===-1){state.promos.push(c);state.currentPromo='';render()}else if(state.promos.indexOf(c)!==-1){alert('Code d√©j√† utilis√©!');state.currentPromo=''}else{alert('Code invalide!');state.currentPromo=''}}
        function removePromo(code){state.promos=state.promos.filter(function(p){return p!==code});render()}
        function calcSub(){return state.cart.reduce(function(s,i){return s+(i.price*i.quantity)},0)}
        function calcDisc(){var total=0;state.promos.forEach(function(p){total+=promoCodes[p]||0});return calcSub()*(total/100)}
        function calcTotal(){return calcSub()-calcDisc()}
        function order(){if(!state.cart.length){alert('Panier vide!');return}if(!confirm('Confirmer?\n\nTotal: '+calcTotal().toFixed(2)+'‚Ç¨'))return;var o={user:state.user.username,userId:state.user.id,items:state.cart,sub:calcSub().toFixed(2),disc:calcDisc().toFixed(2),total:calcTotal().toFixed(2),promos:state.promos.join(', ')||'Aucun',comment:state.comment||'Aucun',date:new Date().toLocaleString('fr-FR')},txt=o.items.map(function(i){return i.emoji+' **'+i.name+'** x'+i.quantity+' - '+(i.price*i.quantity).toFixed(2)+'‚Ç¨'}).join('\n'),e={embeds:[{title:'üç∫ Commande',color:0xFFA500,fields:[{name:'üë§',value:o.user,inline:true},{name:'üìÖ',value:o.date,inline:true},{name:'üçª',value:txt},{name:'üí∞',value:'Total: **'+o.total+'‚Ç¨**'},{name:'üéüÔ∏è',value:o.promos}],timestamp:new Date().toISOString()}]};if(state.comment!=='Aucun')e.embeds[0].fields.push({name:'üí¨',value:state.comment});fetch(WEBHOOK_URL,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(e)}).then(function(r){if(r.ok){state.orderHist.unshift(o);alert('‚úÖ Commande envoy√©e!');state.cart=[];state.promos=[];state.comment='';state.page='orderHist';render()}else alert('‚ùå Erreur')}).catch(function(){alert('‚ùå Erreur')})}
        function generateNums(){var n=[];for(var i=0;i<20;i++)n.push(Math.floor(Math.random()*90)+10);return n}
        function startScratch(){var c=state.code.toUpperCase().trim();if(!c){alert('Entrez un code!');return}if(!tickets[c]){alert('‚ùå Code invalide!');return}if(state.used.indexOf(c)!==-1){alert('‚ùå Code utilis√©!');return}state.used.push(c);var t=tickets[c],w=[],nums=generateNums();for(var i=0;i<6;i++)w.push(nums[Math.floor(Math.random()*20)]);if(t.w>0){var replaceIdx=Math.floor(Math.random()*20);for(var j=0;j<Math.min(3,6);j++){nums[replaceIdx]=w[j];replaceIdx=(replaceIdx+4)%20}}state.winNums=w;state.yourNums=nums;state.win=t.w;state.scratching=true;globalScratched.push({code:c,win:t.w,user:state.user.username,date:new Date().toLocaleString('fr-FR')});render();setTimeout(function(){initCanvas()},100)}
        function initCanvas(){canvas=document.getElementById('canvas');if(!canvas)return;ctx=canvas.getContext('2d');canvas.width=canvas.parentElement.offsetWidth;canvas.height=canvas.parentElement.offsetHeight;var g=ctx.createLinearGradient(0,0,canvas.width,canvas.height);g.addColorStop(0,'#4169E1');g.addColorStop(1,'#1E90FF');ctx.fillStyle=g;ctx.fillRect(0,0,canvas.width,canvas.height);ctx.font='bold 24px Poppins';ctx.fillStyle='white';ctx.textAlign='center';ctx.fillText('GRATTEZ POUR R√âV√âLER',canvas.width/2,canvas.height/2-20);ctx.font='40px Arial';ctx.fillText('üíµ',canvas.width/2,canvas.height/2+30);canvas.addEventListener('mousedown',function(){down=true});canvas.addEventListener('mouseup',function(){down=false});canvas.addEventListener('mousemove',scratch);canvas.addEventListener('touchstart',function(e){e.preventDefault();down=true});canvas.addEventListener('touchend',function(){down=false});canvas.addEventListener('touchmove',function(e){e.preventDefault();scratch(e.touches[0])})}
        function scratch(e){if(!down)return;var r=canvas.getBoundingClientRect(),x=(e.clientX||e.pageX)-r.left,y=(e.clientY||e.pageY)-r.top;ctx.globalCompositeOperation='destination-out';ctx.beginPath();ctx.arc(x,y,40,0,Math.PI*2);ctx.fill();check()}
        function check(){var d=ctx.getImageData(0,0,canvas.width,canvas.height).data,t=0;for(var i=3;i<d.length;i+=4)if(d[i]===0)t++;pct=(t/(d.length/4))*100;if(pct>70)reveal()}
        function reveal(){down=false;var s={user:state.user.username,userId:state.user.id,code:state.code,win:state.win,date:new Date().toLocaleString('fr-FR')};var e={embeds:[{title:'üé∞ Ticket - Taverne McCain',color:state.win>0?0x00FF00:0xFF0000,fields:[{name:'üë§',value:s.user,inline:true},{name:'üéüÔ∏è',value:s.code,inline:true},{name:state.win>0?'üéâ GAGN√â!':'üò¢ Perdu',value:state.win>0?'**'+state.win+'‚Ç¨**':'Pas de gain'},{name:'üìÖ',value:s.date}],timestamp:new Date().toISOString()}]};fetch(WEBHOOK_URL,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(e)});setTimeout(function(){if(state.win>0)alert('üéâ Gagn√© '+state.win+'‚Ç¨!');else alert('üò¢ Pas de gain...');state.scratching=false;state.code='';pct=0;state.page='scratchList';render()},500)}
        function render(){var app=document.getElementById('app'),nav=state.user?'<nav class="bg-orange-800 text-white shadow-lg"><div class="container mx-auto px-4 py-4"><div class="flex items-center justify-between flex-wrap gap-4"><h1 class="text-xl md:text-2xl font-bold">üç∫ Taverne McCain</h1><div class="flex flex-wrap items-center gap-3 text-xs md:text-base"><button onclick="state.page=\'welcome\';render()" class="hover:text-orange-200 '+(state.page==='welcome'?'text-orange-200':'')+'">üè†</button><button onclick="state.page=\'shop\';render()" class="hover:text-orange-200 '+(state.page==='shop'?'text-orange-200':'')+'">üõí</button><button onclick="state.page=\'scratch\';render()" class="hover:text-orange-200 '+(state.page==='scratch'||state.page==='scratchList'?'text-orange-200':'')+'">üé∞</button><button onclick="state.page=\'profile\';render()" class="hover:text-orange-200 '+(state.page==='profile'?'text-orange-200':'')+'">üë§</button><button onclick="logout()" class="hover:text-red-200">üö™</button></div></div></div></nav>':'';if(!state.user){app.innerHTML='<div><nav class="bg-orange-800 text-white shadow-lg py-4"><div class="container mx-auto px-4"><h1 class="text-2xl md:text-3xl font-bold text-center">üç∫ Taverne McCain</h1></div></nav><div class="container mx-auto px-4 py-8 md:py-12"><div class="max-w-6xl mx-auto"><section class="bg-white rounded-2xl shadow-2xl p-6 md:p-8 mb-8"><div class="text-center mb-8 md:mb-12"><h2 class="text-3xl md:text-5xl font-bold text-orange-800 mb-4">Bienvenue</h2><p class="text-lg md:text-xl text-gray-600">Bar en ligne avec jeux</p></div><div class="grid md:grid-cols-3 gap-6 md:gap-8 mb-8 md:mb-12"><div class="text-center p-4 md:p-6 bg-orange-50 rounded-xl"><div class="text-4xl md:text-5xl mb-4">üç∫</div><h3 class="text-xl md:text-2xl font-bold text-orange-800 mb-2">Bar</h3><p class="text-sm md:text-base text-gray-600">Bi√®res, vin</p></div><div class="text-center p-4 md:p-6 bg-orange-50 rounded-xl"><div class="text-4xl md:text-5xl mb-4">üé∞</div><h3 class="text-xl md:text-2xl font-bold text-orange-800 mb-2">Tickets</h3><p class="text-sm md:text-base text-gray-600">Jusqu\'√† 500‚Ç¨</p></div><div class="text-center p-4 md:p-6 bg-orange-50 rounded-xl"><div class="text-4xl md:text-5xl mb-4">üöÄ</div><h3 class="text-xl md:text-2xl font-bold text-orange-800 mb-2">Livraison</h3><p class="text-sm md:text-base text-gray-600">En ligne</p></div></div><div class="text-center"><button onclick="login()" class="bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 md:py-4 px-6 md:px-12 rounded-xl inline-flex items-center gap-3 transform hover:scale-105 text-base md:text-xl"><svg class="w-6 h-6 md:w-8 md:h-8" fill="currentColor" viewBox="0 0 24 24"><path d="M20.317 4.37a19.791 19.791 0 0 0-4.885-1.515a.074.074 0 0 0-.079.037c-.21.375-.444.864-.608 1.25a18.27 18.27 0 0 0-5.487 0a12.64 12.64 0 0 0-.617-1.25a.077.077 0 0 0-.079-.037A19.736 19.736 0 0 0 3.677 4.37a.07.07 0 0 0-.032.027C.533 9.046-.32 13.58.099 18.057a.082.082 0 0 0 .031.057a19.9 19.9 0 0 0 5.993 3.03a.078.078 0 0 0 .084-.028a14.09 14.09 0 0 0 1.226-1.994a.076.076 0 0 0-.041-.106a13.107 13.107 0 0 1-1.872-.892a.077.077 0 0 1-.008-.128a10.2 10.2 0 0 0 .372-.292a.074.074 0 0 1 .077-.01c3.928 1.793 8.18 1.793 12.062 0a.074.074 0 0 1 .078.01c.12.098.246.198.373.292a.077.077 0 0 1-.006.127a12.299 12.299 0 0 1-1.873.892a.077.077 0 0 0-.041.107c.36.698.772 1.362 1.225 1.993a.076.076 0 0 0 .084.028a19.839 19.839 0 0 0 6.002-3.03a.077.077 0 0 0 .032-.054c.5-5.177-.838-9.674-3.549-13.66a.061.061 0 0 0-.031-.03zM8.02 15.33c-1.183 0-2.157-1.085-2.157-2.419c0-1.333.956-2.419 2.157-2.419c1.21 0 2.176 1.096 2.157 2.42c0 1.333-.956 2.418-2.157 2.418zm7.975 0c-1.183 0-2.157-1.085-2.157-2.419c0-1.333.955-2.419 2.157-2.419c1.21 0 2.176 1.096 2.157 2.42c0 1.333-.946 2.418-2.157 2.418z"/></svg>Connexion</button></div></section><section class="bg-white rounded-2xl shadow-2xl p-6 md:p-8"><h2 class="text-2xl md:text-3xl font-bold text-orange-800 mb-6 text-center">Tarifs</h2><div class="grid md:grid-cols-2 gap-4 md:gap-6">'+Object.keys(products).map(function(c){return'<div class="bg-orange-50 p-4 md:p-6 rounded-xl"><h3 class="text-lg md:text-xl font-bold text-orange-800 mb-4 capitalize">'+c+'</h3><div class="space-y-2">'+products[c].map(function(p){return'<div class="flex justify-between text-sm md:text-base"><span>'+p.emoji+' '+p.name+'</span><span class="font-bold">'+p.price.toFixed(2)+'‚Ç¨</span></div>'}).join('')+'</div></div>'}).join('')+'</div></section></div></div></div>';return}if(state.page==='welcome'){app.innerHTML=nav+'<div class="container mx-auto px-4 py-8 md:py-12"><div class="max-w-4xl mx-auto text-center"><div class="bg-white rounded-2xl shadow-2xl p-6 md:p-12"><h1 class="text-3xl md:text-5xl font-bold text-orange-800 mb-4">Bienvenue '+state.user.username+'! üç∫</h1><p class="text-base md:text-xl text-gray-600 mb-8">Que voulez-vous faire?</p><div class="grid md:grid-cols-2 gap-6"><button onclick="state.page=\'shop\';render()" class="bg-orange-600 hover:bg-orange-700 text-white font-bold py-6 md:py
     window.addEventListener('load',function(){getUser();render()})
    </script>
</body>
</html>
